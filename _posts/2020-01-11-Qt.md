---
layout: post
title:  "Qt 开发"
---

* content
{:toc}

## Qt

2020，新的一年到来了！

可是新一年的第一篇博客来得就有些晚，主要是由于最近在受到**期末考试**和**科研项目**的双重打压下，实在是没时间写博客。（*绝对不是因为我偷懒了！*）

为了提升一下自己以及项目需求，研究了一下 Qt。实际上使用 Qt 进行开发，相较于 MFC 来说，简直是十分方便了。（*但其实也没得选，完全看项目需求*）

> Qt 是一个 1991 年由 Qt Company 开发的跨平台 C++ 图形用户界面应用程序开发框架。它既可以开发 GUI 程序，也可用于开发非 GUI 程序，比如控制台工具和服务器。Qt 是面向对象的框架，使用特殊的代码生成扩展（称为元对象编译器 (Meta Object Compiler, moc) ）以及一些宏，Qt 很容易扩展，并且允许真正地组件编程。2008 年，Qt Company 科技被诺基亚公司收购，Qt 也因此成为诺基亚旗下的编程语言工具。2012 年，Qt 被 Digia 收购。2014 年 4 月，跨平台集成开发环境 Qt Creator 3.1.0 正式发布，实现了对于 iOS 的完全支持，新增 WinRT、Beautifier 等插件，废弃了无 Python 接口的 GDB 调试支持，集成了基于 Clang 的 C/C++ 代码模块，并对 Android 支持做出了调整，至此实现了全面支持 iOS、Android、WP，它提供给应用程序开发者建立艺术级的图形用户界面所需的所有功能。基本上，Qt 同 X Window 上的 Motif，Openwin，GTK 等图形界面库和 Windows 平台上的 MFC，OWL，VCL，ATL 是同类型的东西。

<!-- more --> <!-- 摘要预览与正文的分隔符 -->

Qt 主要有以下优点：

1、优良的跨平台特性。

Qt 支持下列操作系统：Microsoft Windows，Linux，Solaris， SunOS， HP-UX， Digital UNIX (OSF/1，Tru64)，Irix，FreeBSD，BSD/OS，SCO，AIX，OS390，QNX 等等。

2、面向对象。

Qt 的良好封装机制使得 Qt 的模块化程度非常高，可重用性较好，对于用户开发来说非常方便。 Qt 提供了一种称为 signals/slots 的安全类型来替代 callback，使得各个元件之间的协同工作变得十分简单。

3、丰富的 API。

Qt 包括多达 250 个以上的 C++ 类，还提供基于模板的 collections， serialization，file，I/O device，directory management，date/time 类。

4、支持 2D/3D 图形渲染，支持 OpenGL。

5、大量的开发文档。

6、XML 支持。

---

## Qt & MFC

之前我做开发的话，用 MFC 用得比较多。但 MFC 有一个致命的缺陷，那就是无法跨平台。

接下来，就简单地总结下 Qt 和 MFC 的差异。

**1、运行效率**

MFC 由于其浅层封装的特点，所以运行效率是比较高的。Qt 因为库比较庞大，封装层次较深，所以运行效率 MFC 为低。MFC 是专为 Windows 设计的，而 Qt 是跨平台的。所以 MFC 编写的程序的运行速度、响应时间都优于 Qt。 

**2、消息循环**

MFC 是事件驱动的架构。要执行任何操作，都必须是对特定的消息作出响应。

Qt 的消息机制是建立在 SIGNAL() 发送和 SLOT() 接受的基础上的。这个机制是对象间建立联系的核心机制。利用SIGNAL() 可以传递任何的参数。

**3、创建界面**

MFC 无法创建大小动态可变的子窗口 ，必须重新手动修改代码来改变窗口的位置。

在 Qt 中，任何东西都可以手动敲出来，因为它很简单：为了得到一个 button，可以这样些 button = new PushButton("buttonName", MyParentName);。如果想在按下某个按钮以后想调用某断代码的执行，可以这样写：connect(button, SIGNAL(clicked()), qApp, SLOT(action()));。

Qt还提供了一个图形用户工具，Qt Designer，可以用来帮助建立用户界面。可以修改所使用的任何控件的属性。不用将他们放在严格的位置，可以通过 layout 完美地组织他们。这个工具所产生的代码我们是可以实际上阅读并且可以理解的。生成的代码单独放在一个文件里，在编程的同时，你可以随心所欲的多次重新生成用户界面。

**4、帮助文档**

Visual 的开发环境的帮助文档 MSDN 非常庞大。包罗万象，涵盖广泛。但是难免有主题模糊、关键信息不突出的遗憾。

Qt 的文档完备且详细的覆盖了 Qt 的方方面面，竟然仅有 18M。每一个类和方法都被详尽描述，举例充实。

**5、Unicode**

使用 MFC，如果要显示 unicode，在编译链接的时候必须用到特殊的参数，必须在每个string前面加上T，将 char 修改成 TCHAR，每个字符串处理函数 (strcpy(), strdup(), strcat()...... ) 都要改变成另外的函数名。

这是个很严重的问题，但是你毫无选择。

使用Qt，字符串用 QString 来处理，其本身是与生俱来的 Unicode，不需要改变什么东西。

QSting 提供了转换为 char* 和 UTF8 的函数。显然，MFC 的 CString 的设计相比于 Qt 的 QString 设计有着巨大的不同。CString 以 char* 为基础提供了很少的功能。它的优点是当需要 char* 类型的时候，可以直接使 CString 类型。

**6、resources 问题**

使用 MFC，一部分开发过程要依靠“resources”，在很多的案例中开发者必须使用他们。这样会导致如下的后果：除了 Visual Studio，你很难使用其他的工具来完成开发。 资源编辑器仅有有限的功能，比如：通过Dialog编辑器不可能改变所有的属性，一些属性可以改变，另一些属性则不可能改变。

Qt 并没有资源的概念，这就解决了以上所提到的问题。Qt 提供了一个脚本使得能将编入你的代码。对于界面设计，Qt Designer 则创建了可读的代码。 

**7、发布**

在发布基于 MFC 的软件时，必须依靠存在于客户电脑上的 MFC。但是这是不安全的，同样是 MFC42.dll，可以基于相同的库得到 3 个不同的版本。通常，需要检查是否拥有正确的 MFC42.dll 版本，如果不是，就升级它。但是升级 MFC42.dll 会改变很多软件的行为。

Qt 则没有这个风险，因为 Qt 压根就没有“升级整个系统”这个概念。

**8、伪对象 & 真对象**

Qt 和 MFC 的差异在于其设计的差异。MFC 的根本目的是访问包装起来的用 C 写的 windows 的 API。

Qt 的架构明显是经过精心设计的面向对象的。因此 Qt 在命名、继承、类的组织等方面保持了优秀的一致性。

现在windows的普及范围谁能比过，所以MFC的客户量比较多，QT主要是Linux下的开发人员在使用，但MFC也只是得益于windows，MFC不支持嵌入式开发，但是QT有对应的模块。

**9、学习难度**

Qt 的封装哲学比较明晰，和系统隔离得比较好，门槛不高。

MFC 较难精通，因为深入开发之后 SDK 还是要了解的。